generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mongodb"
    url      = env("MONGO_URI")
}

enum productStatus {
    Active
    Pending
    Draft
}

model images {
    id         String    @id @default(auto()) @map("_id") @db.ObjectId
    file_id    String
    url        String
    userId     String?   @unique @db.ObjectId
    shopId     String?   @unique @db.ObjectId
    users      users?    @relation(fields: [userId], references: [id])
    shops      shops?    @relation(fields: [shopId], references: [id])
    products   products? @relation(fields: [productsId], references: [id])
    productsId String?   @db.ObjectId
}

model users {
    id         String      @id @default(auto()) @map("_id") @db.ObjectId
    name       String
    email      String      @unique
    password   String?
    avatar     images?
    following  String[]
    createdAt  DateTime    @default(now())
    updatedAt  DateTime    @updatedAt
    shopReview shopReview?
}

model shops {
    id           String  @id @default(auto()) @map("_id") @db.ObjectId
    name         String
    bio          String?
    avatar       images?
    category     String
    cover_banner String?
    address      String
    opening_hour String?
    website      String?
    social_Link  Json[]
    rating       Float   @default(0)
    sellerId     String? @unique @db.ObjectId

    sellers   sellers?     @relation(fields: [sellerId], references: [id])
    reviews   shopReview[]
    createdAt DateTime     @default(now())
    updatedAt DateTime     @updatedAt
    products  products[]
}

model shopReview {
    id String @id @default(auto()) @map("_id") @db.ObjectId

    userId  String? @unique @db.ObjectId
    users   users?  @relation(fields: [userId], references: [id])
    rating  Float
    reviews String?

    shopsId String? @unique @db.ObjectId
    shops   shops?  @relation(fields: [shopsId], references: [id])
}

model sellers {
    id           String   @id @default(auto()) @map("_id") @db.ObjectId
    name         String
    email        String   @unique
    phone_number String
    country      String
    stripeId     String?
    password     String?
    shop         shops?
    createdAt    DateTime @default(now())
    updatedAt    DateTime @updatedAt
    shopId       String?  @db.ObjectId
    shopsId      String?  @db.ObjectId
}

model site_config {
    id            String   @id @default(auto()) @map("_id") @db.ObjectId
    categories    String[]
    subCategories Json
}

model discount_codes {
    id            String   @id @default(auto()) @map("_id") @db.ObjectId
    public_name   String
    discountType  String
    discountValue Float
    discountCode  String   @unique
    sellerId      String   @db.ObjectId
    createdAt     DateTime @default(now())
    updatedAt     DateTime @updatedAt
}

model products {
    id                     String    @id @default(auto()) @map("_id") @db.ObjectId
    title                  String
    detailed_description   String
    short_description      String
    warranty               String?
    customer_specification Json?
    tags                   String[]
    slug                   String    @unique
    brand                  String?
    category               String
    video_url              String?
    colors                 String[]
    sizes                  String[]
    starting_date          DateTime?
    end_date               DateTime?
    stock                  Int
    ratings                Float     @default(5)
    sale_price             Float
    regular_price          Float
    subCategory            String
    customProperties       Json
    images                 images[]
    isDeleted              Boolean?  @default(false)
    cash_on_delivery       String?

    discountCodes String[]      @db.ObjectId
    status        productStatus @default(Active)
    deletedAt     DateTime?
    createdAt     DateTime      @default(now())
    updatedAt     DateTime      @updatedAt
    shopId        String        @db.ObjectId

    Shop shops @relation(fields: [shopId], references: [id])
}
